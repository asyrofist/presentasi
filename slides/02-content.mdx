import { Appear, Embed, Notes } from 'mdx-deck'
import { CodeSurferLayout } from 'code-surfer'

# Pengujian 
- Bagaimana Cara Kerja Word2vec?
- Hasil Pengujian Word2Vec
- Bagaimana cara kerja WMD?
- Hasil Pengujian WMD
  [...](https://docs.google.com/presentation/d/1O0E7MSXf-KOGmXD05FlminhMrGlvBINZcYu-crI45vQ/edit?usp=sharing)

---
<CodeSurferLayout>

```python
def build_lexicon(corpus):
    lexicon = set()
    for doc in corpus:
        lexicon.update([word for word in doc])
    return lexicon
```
  
```python
# define a function that computes cosine similarity between two words
def cosine_similarity(v1, v2):
    return 1 - spatial.distance.cosine(v1, v2)

```

```python
def euclidean_dist(vec1, vec2):
    return np.sqrt(np.sum((vec1-vec2)**2))
```

```python

  class wmdistance(object):
    
    def __init__(self):
        self.stopwords = stopwords.words('english')
        self.w2v_path = 'GoogleNews-vectors-negative300.bin.gz'
        self.loadW2V()
        self.w2v_model.init_sims(replace=True)
        print("\nloaded word2vec model : ")
    
    
    def loadW2V(self):
        if not os.path.exists(self.w2v_path):
            raise ValueError("SKIP: You need to download the google news model")
        self.w2v_model = KeyedVectors.load_word2vec_format(self.w2v_path, limit=300000, binary=True)  
```
  
```python

    def createWmdDataset(self, sent):
        return [wrd for wrd in sent.split() if wrd not in self.stopwords]

    def getWmDistance(self, sent_1, sent_2):
        distance = ''
        try:
            sent_1 = self.createWmdDataset(sent_1)
            sent_2 = self.createWmdDataset(sent_2)
            distance = self.w2v_model.wmdistance(sent_1, sent_2)

            print("\n the word movers distance is => ",distance)
        except Exception as e:
            print("\n Error in getWmDistance --- ", e, "\n", traceback.format_exc())
        return distance

  
```
</CodeSurferLayout>
